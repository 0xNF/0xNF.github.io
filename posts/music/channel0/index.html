<!doctype html><html dir=ltr lang=en data-theme class="html theme--light"><head><title>|
Music Channel Part 1 - Data</title><meta charset=utf-8><meta name=generator content="Hugo 0.109.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content><meta name=description content="Wherein I describe my initial steps on creating a music channel like Trap Nation and TheSoundYouNeed"><link rel=stylesheet href=/scss/main.min.5794be192d21535bdd301561e043a96b6adbad2b5c08279deff459e4661c613f.css integrity="sha256-V5S+GS0hU1vdMBVh4EOpa2rbrStcCCed7/RZ5GYcYT8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.31b0a1f317f55c529a460897848c97436bb138b19c399b37de70d463a8bf6ed5.css integrity="sha256-MbCh8xf1XFKaRgiXhIyXQ2uxOLGcOZs33nDUY6i/btU=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=canonical href=https://0xnf.github.io/posts/music/channel0/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc=" crossorigin=anonymous></script><meta name=twitter:card content="summary"><meta name=twitter:title content="Music Channel Part 1 - Data"><meta name=twitter:description content="Wherein I describe my initial steps on creating a music channel like Trap Nation and TheSoundYouNeed"><meta property="og:title" content="Music Channel Part 1 - Data"><meta property="og:description" content="Wherein I describe my initial steps on creating a music channel like Trap Nation and TheSoundYouNeed"><meta property="og:type" content="article"><meta property="og:url" content="https://0xnf.github.io/posts/music/channel0/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2019-03-25T18:17:32-07:00"><meta property="article:modified_time" content="2019-03-25T18:17:32-07:00"><meta property="og:see_also" content="https://0xnf.github.io/posts/music/channel1/"><meta property="og:see_also" content="https://0xnf.github.io/posts/music/channel2/"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Music Channel Part 1 - Data","headline":"Music Channel Part 1 - Data","alternativeHeadline":"","description":"
      Wherein I describe my initial steps on creating a music channel like Trap Nation and TheSoundYouNeed


    ","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/0xnf.github.io\/posts\/music\/channel0\/"},"author":{"@type":"Person","name":""},"creator":{"@type":"Person","name":""},"accountablePerson":{"@type":"Person","name":""},"copyrightHolder":{"@type":"Person","name":""},"copyrightYear":"2019","dateCreated":"2019-03-25T18:17:32.00Z","datePublished":"2019-03-25T18:17:32.00Z","dateModified":"2019-03-25T18:17:32.00Z","publisher":{"@type":"Organization","name":null,"url":"https://0xnf.github.io/","logo":{"@type":"ImageObject","url":"https:\/\/0xnf.github.io\/favicon-32x32.png","width":"32","height":"32"}},"image":[],"url":"https:\/\/0xnf.github.io\/posts\/music\/channel0\/","wordCount":"1991","genre":["music channel"],"keywords":["YouTube","Branding","Marketing","Music"]}</script></head><body class=body><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
animated fadeInDown"><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src=/ alt="profile picture"><div class=sidebar__introduction-title><a href=/></a></div><div class=sidebar__introduction-description><p></p></div></div><ul class=sidebar__list></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></div></aside><main class=wrapper__main><header class=header><div class="animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
animated fadeInDown"><div class=post__content><h1>Music Channel Part 1 - Data</h1><p>This is the first in a series of posts about analyzing YouTube music channels.</p><ul><li>Part 1 - Music Channel Introduction and Data Collection</li><li><a href=/posts/music/channel1>Part 2 - Analysis of Channel Activity</a></li><li><a href=/posts/music/channel2>Part 3 - Branding</a></li></ul><h1 id=background>Background</h1><p>I often listen to new music on YouTube because their discovery systems unearth some occasionally great finds. After a while of listening there however you begin to realize that there are only a handful of channels that get recommended to you, and they all seem to just upload songs and let the views roll in, not unlike a radio DJ. Sometimes these channels become so successful that artists will begin to sign with the channels for exclusive releases, in effect turning the channels into a de-facto label. Some of these channels have even turned into de-jure labels, such as Proximity.</p><p>I thought it would be a fun experiment to see if I could create a YouTube channel of my own doing the same thing these channels were doing. It seemed easy enough, just upload a few songs here and there. But before I began, I wanted to get a sense of what, exactly, these channels were doing, what their upload schedule was actually like, what were they like when they started out, how did they evolve, etc.</p><p>This series of posts describes just such an analysis of a selection of music channels on YouTube.</p><h1 id=data-collection>Data Collection</h1><p>First, I wanted to get a sense of how these channels upload songs, which would help inform me on how run my own channel. The questions that I wanted answers to before starting were:</p><ol><li>How many videos should we seed our channel with?</li><li>How often should we upload?</li><li>Should we upload more than video at once?</li><li>How long can we wait between uploads if something goes wrong?</li></ol><h2 id=yt-tracker>YT Tracker</h2><p>To answer these questions, I had to get some data first. I wasn&rsquo;t about to scrape YouTube myself, so after some googling for some tools that could help me gather some channel stats, I came across the excellent <a href=https://chrome.google.com/webstore/detail/yt-tracker/nhebilhcolhlinfcpgbpbecjajeiiajc>YT Tracker</a>, an addon for Google Sheets that pulls all kinds of channel information for you.</p><p>You can find its full functionality detailed <a href=https://www.syncwithtech.org/track-youtube-videos-channels/>here</a>.</p><h3 id=channel-list>Channel List</h3><p>First I seeded YT Tracker with a list of 7 of the channels I either use or happen to come across often:</p><ol><li><a href=https://www.youtube.com/channel/UCudKvbd6gvbm5UCYRk5tZKA>TheSoundYouNeed</a></li><li><a href=https://www.youtube.com/channel/UCXIyz409s7bNWVcM-vjfdVA>MajesticCasual</a></li><li><a href=https://www.youtube.com/channel/UC5nc_ZtjKW1htCVZVRxlQAQ>MrSuicideSheep</a></li><li><a href=https://www.youtube.com/channel/UCM9KEEuzacwVlkt9JfJad7g>ChillNation</a></li><li><a href=https://www.youtube.com/channel/UCa1Q2ic8wDlT1WH7LSO_4Sg>Eton Messy</a></li><li><a href=https://www.youtube.com/channel/UCJ6td3C9QlPO9O_J5dF4ZzA>MonsterCat</a></li><li><a href=https://www.youtube.com/channel/UCjw0SX_9OGFI7buLG4-M0Fw>MikuMusicNetwork</a></li></ol><p>As the developer of YT Tracker writes on his page, it can sometimes be tricky to extract the channel name from some pages. If you&rsquo;re on a page for a given video, the main uploader link in the video description will contain the channel name - this goes for accounts that are flagged as &ldquo;user&rdquo;, as well for for &ldquo;channel&rdquo; accounts. This is important because YT Tracker only operates on channel ids.</p><h3 id=adding-to-a-yt-tracker-sheet>Adding to a YT Tracker Sheet</h3><p>We add the channel ids to the first column:</p><p><img src=/misc/musicchannel/YtTracker_ChannelIds.png alt="Channel Ids"></p><p>YT Tracker takes care of filling in the rest of the data automatically. It&rsquo;s really quite magical.</p><h3 id=grabbing-video-data>Grabbing Video Data</h3><p>Next we want to grab video data from each channel. With the channel id cell of the channel we want to grab highlighted, we use the Add-Ons drop down menu to select YT Tracker and select <code>Fetch Channel Videos</code>, which will create a new sheet for us, populated with video upload data:</p><p><img src=/misc/musicchannel/YtTracker_VideoData.png alt="Video Data"></p><p>You have to do this highlight-menu-fetch process for each item in our list.</p><h3 id=exporting>Exporting</h3><p>Next we&rsquo;ll take each sheet and Save-As <code>.csv</code> to some folder on our computer.</p><p>This is the first step to getting the data into a SQL-queryable format.</p><h1 id=data-cleanup-part-1>Data Cleanup Part 1</h1><p>Every project that involves data will require some form of cleanup process, this is no different.</p><h2 id=csv-cleanup>CSV Cleanup</h2><h3 id=adding-channel-id>Adding Channel Id</h3><p>Because we&rsquo;re going to end up putting all this data into SQLite, we need to do some work on the CSV files first. To make our data amenable, one of the things we&rsquo;ll do is add the channel name to each row of each CSV.</p><p>For example, we&rsquo;re going to turn:</p><pre tabindex=0><code class=language-csv data-lang=csv>Video Id,Title,Thumbnail,Publish On,Duration,# of Views,# of Likes,# of Dislikes,# of Comments
x8Y2iCSGSXI,Nora Van Elken - Best I Ever Had,,2018-10-11,3 : 02,&#34;58,593&#34;,&#34;3,082&#34;,78,141
</code></pre><p>into</p><pre tabindex=0><code class=language-csv data-lang=csv>Video Id,Title,Thumbnail,Publish On,Duration,# of Views,# of Likes,# of Dislikes,# of Comments
ChillNation,x8Y2iCSGSXI,Nora Van Elken - Best I Ever Had,,2018-10-11,3:02,&#34;58,593&#34;,&#34;3,082&#34;,78,141
</code></pre><p>I did this with the following two regexs:</p><pre tabindex=0><code>find: ^([0-9A-Za-z_-]*)?,
replace: ChillNation,$1,
</code></pre><p>where ChillNation is whatever channel you&rsquo;re actually working with.</p><p>Be sure to add the Column name of ChannelName before Video Id.</p><h3 id=patching-up-time>Patching up Time</h3><p>The timestamps are bit messy - consistent, but full of weird spaces that make parsing a bit of a pain.</p><p>We want to turn</p><pre tabindex=0><code>3 : 02
1 : 26 : 27
</code></pre><p>into</p><pre tabindex=0><code>3:02
1:26:27
</code></pre><p>We fix this with the following regex find/replaces:</p><pre tabindex=0><code>find: ([0-9]{0,2})\s+:\s+([0-9]{0,2})
replace: $1:$2
</code></pre><p>Which we run twice to catch any hour+ long tracks with hh:mm:ss formatting.</p><h3 id=changing-column-names>Changing Column Names</h3><p>The exported named columns would make for some difficult SQL querying. To make our life easier, we&rsquo;ll change the names:</p><pre tabindex=0><code>Channel,VID,Title,Thumbnail,Published,Duration,Views,Likes,Dislikes,Comments
</code></pre><h2 id=sql-part-1>SQL Part 1</h2><p>I like to do as much data processing and analysis in python and sqlite as possible. We&rsquo;ll do that here too, by importing all our exported files into a new Sqlite database.</p><p>I prefer to use <a href=http://sqlitebrowser.org/>DB Browser for SQLite</a>, which is a Windows GUI tool.</p><p>Using the <code>Import -> Table From CSV File</code> menu option, we add in all our exported csv files, saying okay to the <code>append to table?</code> warning. You can call the new table whatever you like, I&rsquo;ve chosen <code>VideoStats</code>.</p><p><img src=/misc/musicchannel/newsqlite.png alt="Import From CSV"></p><h3 id=table>Table</h3><p>After this important, we end up with a table that looks something like this:</p><p><img src=/misc/musicchannel/sql0.png alt="Table Data"></p><p>While a good first step, I realized here that the data wasn&rsquo;t actually in the most useful form. Views, Likes, Dislikes, and Comments all have commas in their data, which makes them strings, not integers.</p><p>Additionally, Duration has colons in it, which makes it a string too.</p><p>The exception is the Published field, which SQLite handles correctly as a date.</p><h3 id=adding-a-duration_ms-column>Adding a Duration_Ms Column</h3><p>Although I want to fix the duration field, I think it might be useful to keep its original form around because its very human-readable. So we&rsquo;ll add another column to our table, <code>Duration_Ms</code>, which will represent the duration of the song in milliseconds:</p><p><img src=/misc/musicchannel/sql1.png alt="Duration MS"></p><h2 id=python-cleanup-part-1>Python Cleanup Part 1</h2><p>We&rsquo;ll use Python here to remedy these errors. This is python at its best - small scripts for data processing.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os<span style=color:#f92672>,</span>sys<span style=color:#f92672>,</span>sqlite3<span style=color:#f92672>,</span>pathlib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dateutil.parser <span style=color:#f92672>import</span> parse <span style=color:#66d9ef>as</span> PDT
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime, timedelta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sqlfile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;./ytrackerstats/ytstats.db&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>fixDuration</span>(dur):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        s <span style=color:#f92672>=</span> dur<span style=color:#f92672>.</span>split(<span style=color:#e6db74>&#39;:&#39;</span>)
</span></span><span style=display:flex><span>        s<span style=color:#f92672>.</span>reverse()
</span></span><span style=display:flex><span>        TotalSeconds <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>for</span> idx,num <span style=color:#f92672>in</span> enumerate(s):
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> num <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;&#39;</span>:
</span></span><span style=display:flex><span>                num <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>            multiplier <span style=color:#f92672>=</span> <span style=color:#ae81ff>60</span> <span style=color:#f92672>**</span> idx
</span></span><span style=display:flex><span>            number <span style=color:#f92672>=</span> int(num)
</span></span><span style=display:flex><span>            seconds <span style=color:#f92672>=</span> number <span style=color:#f92672>*</span> multiplier
</span></span><span style=display:flex><span>            TotalSeconds <span style=color:#f92672>+=</span> seconds
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> TotalSeconds <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ValueError</span>:
</span></span><span style=display:flex><span>        print(dur)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;???&#34;</span>)
</span></span><span style=display:flex><span>    
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>fixCommaNumber</span>(com):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> type(com) <span style=color:#f92672>is</span> str:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> com <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;undefined&#34;</span>:
</span></span><span style=display:flex><span>                repl <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;0&#34;</span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>else</span>:
</span></span><span style=display:flex><span>                repl <span style=color:#f92672>=</span> com<span style=color:#f92672>.</span>replace(<span style=color:#e6db74>&#39;,&#39;</span>, <span style=color:#e6db74>&#39;&#39;</span>)
</span></span><span style=display:flex><span>            i <span style=color:#f92672>=</span> int(repl)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>elif</span> type(com) <span style=color:#f92672>is</span> int <span style=color:#f92672>or</span> type(com) <span style=color:#f92672>is</span> float:
</span></span><span style=display:flex><span>            i <span style=color:#f92672>=</span> com
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>return</span> i
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>ValueError</span> <span style=color:#66d9ef>as</span> e:
</span></span><span style=display:flex><span>        print(com)
</span></span><span style=display:flex><span>        print(e)
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>raise</span> <span style=color:#a6e22e>Exception</span>(<span style=color:#e6db74>&#34;??&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>FetchAllFromVideoStats</span>():
</span></span><span style=display:flex><span>    connection <span style=color:#f92672>=</span> sqlite3<span style=color:#f92672>.</span>connect(sqlfile)
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> connection<span style=color:#f92672>.</span>cursor()
</span></span><span style=display:flex><span>    c<span style=color:#f92672>.</span>execute(<span style=color:#e6db74>&#34;SELECT VID,Duration,Views,Likes,Dislikes,Comments FROM VideoStats&#34;</span>)
</span></span><span style=display:flex><span>    newRs <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> c:
</span></span><span style=display:flex><span>        vid <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        dur <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        view <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>        like <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>3</span>]
</span></span><span style=display:flex><span>        disl <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>4</span>]
</span></span><span style=display:flex><span>        comm <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>5</span>]
</span></span><span style=display:flex><span>        fixed <span style=color:#f92672>=</span> (fixDuration(dur), fixCommaNumber(view), fixCommaNumber(like), fixCommaNumber(disl), fixCommaNumber(comm), vid)
</span></span><span style=display:flex><span>        newRs<span style=color:#f92672>.</span>append(fixed)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> newRs
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>FixVids</span>(tups):
</span></span><span style=display:flex><span>    connection <span style=color:#f92672>=</span> sqlite3<span style=color:#f92672>.</span>connect(sqlfile)
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> connection<span style=color:#f92672>.</span>cursor()
</span></span><span style=display:flex><span>    q <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;UPDATE VideoStats SET Duration_Ms=?, Views=?, Likes=?, Dislikes=?, Comments=? WHERE VID=?&#34;</span>
</span></span><span style=display:flex><span>    c<span style=color:#f92672>.</span>executemany(q, tups)
</span></span><span style=display:flex><span>    connection<span style=color:#f92672>.</span>commit()
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>test</span>():
</span></span><span style=display:flex><span>    duration <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;03:01:46&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixDuration(duration) <span style=color:#f92672>==</span> <span style=color:#ae81ff>10906000</span>
</span></span><span style=display:flex><span>    comma1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;5,600&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixCommaNumber(comma1) <span style=color:#f92672>==</span> <span style=color:#ae81ff>5600</span>
</span></span><span style=display:flex><span>    comma2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;56&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixCommaNumber(comma2) <span style=color:#f92672>==</span> <span style=color:#ae81ff>56</span>
</span></span><span style=display:flex><span>    comma3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixCommaNumber(comma3) <span style=color:#f92672>==</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>   test()
</span></span><span style=display:flex><span>   vids <span style=color:#f92672>=</span> FetchAllFromVideoStats()
</span></span><span style=display:flex><span>   FixVids(vids)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><p>The summary of this script is that we remove commas from any numbers, and convert durations to their ms representation, which we update into the <code>Duration_Ms</code> field.</p><h2 id=sql-part-2>SQL Part 2</h2><p>Now that most of the data was in SQL, and in a good format, I started running some queries. For instance:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> Channel, Published, <span style=color:#66d9ef>COUNT</span>(Published) <span style=color:#66d9ef>AS</span> Uploaded <span style=color:#66d9ef>FROM</span> VideoStats <span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> Channel,Published <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> Channel, <span style=color:#66d9ef>Count</span>(Published) <span style=color:#66d9ef>DESC</span>
</span></span></code></pre></div><p>Which returns the number of tracks uploaded per channel per day. This is a useful query - Do people typically upload more than one track per day? Who knows? Well now, you do! With the power of Group By.</p><h3 id=another-table>Another Table</h3><p>The problem is that some of these queries started to get a bit cumbersome and unwieldly. Running multiple versions got tiring pretty quick. The soluton was another table. I called this one <code>ChannelPublish</code>.</p><p>I also wanted another piece of data, which would have otherwise been really difficult to extract using just plain SQL: Days since last publish.</p><p>It seemed important to know how many days had passed between consecutive uploads. This is information that can be derived from the data as it exists, but it&rsquo;d be a lot nicer if we had a dedicated field for it. This process is known as Feature Engineering, and is common when working with tabular data.</p><p><img src=/misc/musicchannel/sql2.png alt="Channel Publish Table"></p><h3 id=select-insert>Select Insert</h3><p>To get data into our new table, we run the following query:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>INSERT</span> <span style=color:#66d9ef>INTO</span> ChannelPublish2 (Channel, Published, <span style=color:#66d9ef>Count</span>) 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>SELECT</span> Channel, Published, <span style=color:#66d9ef>COUNT</span>(Published) <span style=color:#66d9ef>AS</span> Uploaded
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>FROM</span> VideoStats 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> Channel,Published 
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>ORDER</span> <span style=color:#66d9ef>BY</span> Channel, <span style=color:#66d9ef>Count</span>(Published) <span style=color:#66d9ef>DESC</span>
</span></span></code></pre></div><p>Which gets us a table composed entirely of the previous group-by query results.</p><h2 id=python-cleanup-part-2>Python Cleanup Part 2</h2><p>Moving back to python, we&rsquo;ll update our script to calculate the number of days since the last upload:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#! /usr/bin/python</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> os<span style=color:#f92672>,</span>sys<span style=color:#f92672>,</span>sqlite3<span style=color:#f92672>,</span>pathlib
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> dateutil.parser <span style=color:#f92672>import</span> parse <span style=color:#66d9ef>as</span> PDT
</span></span><span style=display:flex><span><span style=color:#f92672>from</span> datetime <span style=color:#f92672>import</span> datetime, timedelta
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>sqlfile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;./ytrackerstats/ytstats.db&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>[<span style=color:#f92672>...</span> Edited <span style=color:#66d9ef>for</span> brevity <span style=color:#f92672>...</span>]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>DateDiffRaw</span>(prev, date):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> prev <span style=color:#f92672>==</span> <span style=color:#ae81ff>0</span>:
</span></span><span style=display:flex><span>        prev <span style=color:#f92672>=</span> date
</span></span><span style=display:flex><span>    diff <span style=color:#f92672>=</span> date <span style=color:#f92672>-</span> prev
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> diff<span style=color:#f92672>.</span>days
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>FetchAddDaysSinceLastPublish</span>():
</span></span><span style=display:flex><span>    connection <span style=color:#f92672>=</span> sqlite3<span style=color:#f92672>.</span>connect(sqlfile)
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> connection<span style=color:#f92672>.</span>cursor()
</span></span><span style=display:flex><span>    q <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;SELECT Id, Channel, Published FROM ChannelPublish ORDER BY Channel, Published ASC&#34;</span>
</span></span><span style=display:flex><span>    prev <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>    currentChannel <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>    updates <span style=color:#f92672>=</span> []
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> row <span style=color:#f92672>in</span> c<span style=color:#f92672>.</span>execute(q):
</span></span><span style=display:flex><span>        id <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>0</span>]
</span></span><span style=display:flex><span>        channel <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>1</span>]
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>if</span> currentChannel <span style=color:#f92672>!=</span> channel:
</span></span><span style=display:flex><span>            currentChannel <span style=color:#f92672>=</span> channel
</span></span><span style=display:flex><span>            <span style=color:#75715e># RESET!</span>
</span></span><span style=display:flex><span>            prev <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>        date_raw <span style=color:#f92672>=</span> row[<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>        parsed <span style=color:#f92672>=</span> PDT(date_raw)
</span></span><span style=display:flex><span>        diff <span style=color:#f92672>=</span> DateDiffRaw(prev, parsed)
</span></span><span style=display:flex><span>        prev <span style=color:#f92672>=</span> parsed
</span></span><span style=display:flex><span>        updates<span style=color:#f92672>.</span>append((diff, id))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span> updates
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>UpdateDaysSinceLastPublish</span>(tups):
</span></span><span style=display:flex><span>    connection <span style=color:#f92672>=</span> sqlite3<span style=color:#f92672>.</span>connect(sqlfile)
</span></span><span style=display:flex><span>    c <span style=color:#f92672>=</span> connection<span style=color:#f92672>.</span>cursor()
</span></span><span style=display:flex><span>    q <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;UPDATE ChannelPublish SET DaysSinceLastPublish=? WHERE Id=?&#34;</span>  
</span></span><span style=display:flex><span>    c<span style=color:#f92672>.</span>executemany(q, tups)
</span></span><span style=display:flex><span>    connection<span style=color:#f92672>.</span>commit()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>test</span>():
</span></span><span style=display:flex><span>    duration <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;03:01:46&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixDuration(duration) <span style=color:#f92672>==</span> <span style=color:#ae81ff>10906000</span>
</span></span><span style=display:flex><span>    comma1 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;5,600&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixCommaNumber(comma1) <span style=color:#f92672>==</span> <span style=color:#ae81ff>5600</span>
</span></span><span style=display:flex><span>    comma2 <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;56&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixCommaNumber(comma2) <span style=color:#f92672>==</span> <span style=color:#ae81ff>56</span>
</span></span><span style=display:flex><span>    comma3 <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> fixCommaNumber(comma3) <span style=color:#f92672>==</span> <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    dateEarlier <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;2018-10-09&#34;</span>
</span></span><span style=display:flex><span>    dateLater <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;2018-10-10&#34;</span>
</span></span><span style=display:flex><span>    d1p <span style=color:#f92672>=</span> PDT(dateEarlier)
</span></span><span style=display:flex><span>    d2p <span style=color:#f92672>=</span> PDT(dateLater)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>assert</span> DateDiffRaw(d1p, d2p) <span style=color:#f92672>==</span> <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>main</span>():
</span></span><span style=display:flex><span>   <span style=color:#75715e># test()</span>
</span></span><span style=display:flex><span>   <span style=color:#75715e># vids = FetchAllFromVideoStats()</span>
</span></span><span style=display:flex><span>   <span style=color:#75715e># FixVids(vids)</span>
</span></span><span style=display:flex><span>   dates <span style=color:#f92672>=</span> FetchAddDaysSinceLastPublish()
</span></span><span style=display:flex><span>   UpdateDaysSinceLastPublish(dates)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    main()
</span></span></code></pre></div><h2 id=sql-again>SQL Again</h2><p>Now we have a table of very useful information:</p><p><img src=/misc/musicchannel/sql3.png alt="Useful Information"></p><p>Which lets us easily query for stuff like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-SQL data-lang=SQL><span style=display:flex><span><span style=color:#66d9ef>SELECT</span> 
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>Max</span>(cp.DaysSinceLastPublish) <span style=color:#66d9ef>AS</span> MaxDaysBetweenPosts,
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>CAST</span>(<span style=color:#66d9ef>avg</span>(cp.DaysSinceLastPublish) <span style=color:#66d9ef>AS</span> FLOAT) <span style=color:#66d9ef>AS</span> AvgDaysBetweenPosts,
</span></span><span style=display:flex><span>	cp.Channel <span style=color:#66d9ef>FROM</span> ChannelPublish <span style=color:#66d9ef>AS</span> cp
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>WHERE</span> DaysSinceLastPublish <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>0</span> 
</span></span><span style=display:flex><span>	<span style=color:#75715e>--AND Published &gt; date(&#34;2018-01-01&#34;) 
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>	<span style=color:#66d9ef>GROUP</span> <span style=color:#66d9ef>BY</span> cp.Channel
</span></span></code></pre></div><h1 id=summary>Summary</h1><p>This first post covers the initial setup for being able to graph, chart and otherwise ask statistical questions about some YouTube channels that we&rsquo;re going to use as a basis for our own music channel.</p><p>We gathered our initial dataset, cleaned that data, and put it all into a SQLite file for use later.</p><p>Next time, we&rsquo;ll cover the channel setup, and answer the questions like:</p><ol><li>How many videos should we seed our channel with?</li><li>How often should we upload?</li><li>Should we upload more than video at once?</li><li>How long can we wait between uploads if something goes wrong?</li></ol><p>Once that information is covered, we&rsquo;ll create a list of songs to upload and check to see if our favorite channels have covered them already. The less channels a song appears on of course, the better for our channel. We&rsquo;re not just trying to be a mirror of the others, after all.</p><p>We&rsquo;ll also see what we can do about creating a Channel Icon, selecting some backgrounds, adding that must-have waveform pulse animation, and some initial channel curation.</p><h3>Posts in this series</h3><ul><li><a href=/posts/music/channel2/>Music Channel Part 3 - Branding</a></li><li><a href=/posts/music/channel1/>Music Channel Part 2 - Stats</a></li><li><a href=/posts/music/channel0/>Music Channel Part 1 - Data</a></li></ul></div><div class=post__footer><span><a class=category href=/categories/music-channel/>music channel</a></span>
<span><a class=tag href=/tags/youtube/>YouTube</a><a class=tag href=/tags/branding/>Branding</a><a class=tag href=/tags/marketing/>Marketing</a><a class=tag href=/tags/music/>Music</a></span></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></body></html>