<!doctype html><html dir=ltr lang=en data-theme class="html theme--light"><head><title>|
Swipr - Overview</title><meta charset=utf-8><meta name=generator content="Hugo 0.109.0"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=author content><meta name=description content="Part 1 of a series exploring the full pipeline of AI development for Swipr, a smarter Tinder auto-swiper. We talk the whole shebang from data collection, to productionizing, and webapp deployment."><link rel=stylesheet href=/scss/main.min.5794be192d21535bdd301561e043a96b6adbad2b5c08279deff459e4661c613f.css integrity="sha256-V5S+GS0hU1vdMBVh4EOpa2rbrStcCCed7/RZ5GYcYT8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/css/markupHighlight.min.31b0a1f317f55c529a460897848c97436bb138b19c399b37de70d463a8bf6ed5.css integrity="sha256-MbCh8xf1XFKaRgiXhIyXQ2uxOLGcOZs33nDUY6i/btU=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/fontawesome.min.7d272de35b410fb165377550cdf9c4d3a80fbbcc961e111914e4d5c0eaf5729f.css integrity="sha256-fSct41tBD7FlN3VQzfnE06gPu8yWHhEZFOTVwOr1cp8=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/solid.min.55d8333481b07a08e07cf6f37319753a2b47e99f4c395394c5747b48b495aa9b.css integrity="sha256-VdgzNIGwegjgfPbzcxl1OitH6Z9MOVOUxXR7SLSVqps=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/regular.min.a7448d02590b43449364b6b5922ed9af5410abb4de4238412a830316dedb850b.css integrity="sha256-p0SNAlkLQ0STZLa1ki7Zr1QQq7TeQjhBKoMDFt7bhQs=" crossorigin=anonymous type=text/css><link rel=stylesheet href=/fontawesome/css/brands.min.9ed75a5d670c953fe4df935937674b4646f92674367e9e66eb995bb04e821647.css integrity="sha256-ntdaXWcMlT/k35NZN2dLRkb5JnQ2fp5m65lbsE6CFkc=" crossorigin=anonymous type=text/css><link rel="shortcut icon" href=/favicon.ico type=image/x-icon><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=canonical href=https://0xnf.github.io/posts/ml/swipr01/><script type=text/javascript src=/js/anatole-header.min.f9132794301a01ff16550ed66763482bd848f62243d278f5e550229a158bfd32.js integrity="sha256-+RMnlDAaAf8WVQ7WZ2NIK9hI9iJD0nj15VAimhWL/TI=" crossorigin=anonymous></script>
<script type=text/javascript src=/js/anatole-theme-switcher.min.d6d329d93844b162e8bed1e915619625ca91687952177552b9b3e211014a2957.js integrity="sha256-1tMp2ThEsWLovtHpFWGWJcqRaHlSF3VSubPiEQFKKVc=" crossorigin=anonymous></script><meta name=twitter:card content="summary"><meta name=twitter:title content="Swipr - Overview"><meta name=twitter:description content="Part 1 of a series exploring the full pipeline of AI development for Swipr, a smarter Tinder auto-swiper. We talk the whole shebang from data collection, to productionizing, and webapp deployment."><meta property="og:title" content="Swipr - Overview"><meta property="og:description" content="Part 1 of a series exploring the full pipeline of AI development for Swipr, a smarter Tinder auto-swiper. We talk the whole shebang from data collection, to productionizing, and webapp deployment."><meta property="og:type" content="article"><meta property="og:url" content="https://0xnf.github.io/posts/ml/swipr01/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-11-27T17:41:38-08:00"><meta property="article:modified_time" content="2018-11-27T17:41:38-08:00"><meta property="og:see_also" content="https://0xnf.github.io/posts/ml/swipr02/"><meta property="og:see_also" content="https://0xnf.github.io/posts/ml/swipr03/"><meta property="og:see_also" content="https://0xnf.github.io/posts/ml/swipr04/"><meta property="og:see_also" content="https://0xnf.github.io/posts/ml/swipr05/"><meta property="og:see_also" content="https://0xnf.github.io/posts/ml/swipr06/"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","articleSection":"posts","name":"Swipr - Overview","headline":"Swipr - Overview","alternativeHeadline":"","description":"
      Part 1 of a series exploring the full pipeline of AI development for Swipr, a smarter Tinder auto-swiper. We talk the whole shebang from data collection, to productionizing, and webapp deployment.


    ","inLanguage":"en-us","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/0xnf.github.io\/posts\/ml\/swipr01\/"},"author":{"@type":"Person","name":""},"creator":{"@type":"Person","name":""},"accountablePerson":{"@type":"Person","name":""},"copyrightHolder":{"@type":"Person","name":""},"copyrightYear":"2018","dateCreated":"2018-11-27T17:41:38.00Z","datePublished":"2018-11-27T17:41:38.00Z","dateModified":"2018-11-27T17:41:38.00Z","publisher":{"@type":"Organization","name":null,"url":"https://0xnf.github.io/","logo":{"@type":"ImageObject","url":"https:\/\/0xnf.github.io\/favicon-32x32.png","width":"32","height":"32"}},"image":[],"url":"https:\/\/0xnf.github.io\/posts\/ml\/swipr01\/","wordCount":"642","genre":["machine learning","fast.ai"],"keywords":["CNN","web scraping","data collection","architecture"]}</script></head><body class=body><div class=wrapper><aside class=wrapper__sidebar><div class="sidebar
animated fadeInDown"><div class=sidebar__content><div class=sidebar__introduction><img class=sidebar__introduction-profileimage src=/ alt="profile picture"><div class=sidebar__introduction-title><a href=/></a></div><div class=sidebar__introduction-description><p></p></div></div><ul class=sidebar__list></ul></div><footer class="footer footer__sidebar"><ul class=footer__list><li class=footer__item>&copy;
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></div></aside><main class=wrapper__main><header class=header><div class="animated fadeInDown"><a role=button class=navbar-burger data-target=navMenu aria-label=menu aria-expanded=false><span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span>
<span aria-hidden=true class=navbar-burger__line></span></a><nav class=nav><ul class=nav__list id=navMenu></ul><ul class="nav__list nav__list--end"><li class=nav__list-item><div class=themeswitch><a title="Switch Theme"><i class="fas fa-adjust fa-fw" aria-hidden=true></i></a></div></li></ul></nav></div></header><div class="post
animated fadeInDown"><div class=post__content><h1>Swipr - Overview</h1><h1 id=the-goal>The Goal</h1><p>Continuing the quest to learn modern Machine Learning, I thought it would be fun to create a Tinder auto-swiper that could potentially reject matches I don&rsquo;t want and accept matches I do want.</p><p>One of my friends had the brilliant idea of naming this tinderbot &ldquo;Swiper&rdquo;, like the fox from Dora the Explorer, famous for being repelled by the intrepid protagonists with the incantation of &ldquo;Swiper, no swiping!&rdquo;</p><p>Following internet tradition (Tumblr, Flickr, Scribd, Grindr, etc), we also decided to drop the final &rsquo;e&rsquo;, giving us &ldquo;Swipr&rdquo;. And of course, our tagline is &ldquo;No Swiping.&rdquo;</p><h1 id=the-end-result>The End Result</h1><p>First, let me start up by saying that Swipr is technically available for you to use online. You can find it at <a href=https://swipr.winetech.com>https://swipr.winetech.com</a>.</p><p>I do not recommend signing into it, and I do not recommend using it for your Tinder matches. The reasons are many, but fluctuate between security (I need to permanently store your Facebook password), practicality (both Tinder and Facebook will likely ding your account for signing in from my server&rsquo;s New Jersey location), and usefulness (there is one model and it is trained on my preferences, not yours.)</p><p>But if none of those things bother you, then hey, go for it. The system is architected for multi-user support, so feel free to sign in and let Swipr do the swiping.</p><h1 id=process-overview>Process Overview</h1><p>The entire process took a few weeks start to finish, and involved a number of discrete steps:</p><ol><li>Scope determination</li><li>Data determination, i.e., what should I be collecting?</li><li>Data collection</li><li>Data cleanup</li><li>Neural network training</li><li>Productionizing the model</li><li>Web app creation</li><li>Backend architecture</li></ol><p>And then there&rsquo;s also the regular DevOps and security stuff like encrypting our databases, automating as much of our deployment as possible, and getting Let&rsquo;s Encrypt certs.</p><p>Each of these steps has a bunch of nuance and complexity, some much more than others.</p><h1 id=model-statistics>Model Statistics</h1><p>What good is an article about AI models without some model stats? For a quick overview, here&rsquo;s what we ended up getting out of the core of this whole process:</p><p><em>Dataset Type:</em> a bunch of jpgs<br><em>Dataset Size:</em> 279,262 pictures<br><em>Model Type:</em> ResNext50<br><em>Framework:</em> PyTorch 0.4 and fast.ai<br><em>Epoch Count:</em> roughly 10<br><em>Total Training Time:</em> roughly 24 hours on a Paperspace GPU instance<br><em>Loss Function:</em> Cross Entropy<br><em>Final Loss Values:</em></p><table><thead><tr><th>Training Loss</th><th>Validation Loss</th><th>Accuracy</th></tr></thead><tbody><tr><td>0.370794</td><td>0.361677</td><td>.83086</td></tr></tbody></table><p>Say what you want about an ~83% accuracy, but given that sometimes I&rsquo;m not even sure what I want, this is a pretty solid result.</p><h1 id=quick-notes>Quick Notes</h1><p>Because most of you will never get past this first post, I&rsquo;d like to point out some third party things that we used on this project:</p><p>For the data collection, we used a custom framework built on top of <a href=https://github.com/althonos/InstaLooter>InstaLooter</a> called <a href=https://github.com/0xNF/ilm>ILM</a> which handles batch downloads better.</p><p>To do data cleanup, because Instagram data is inherently noisy and not necessarily all humans, we used a prebuilt facial recognition network called <a href=https://github.com/kuaikuaikim/DFace>DFace</a> to find pictures with faces in them. This network is build on PyTorch. After that, we used the models available by the devs over at the <a href=https://github.com/deepinsight/insightface>DeepInsight/Face</a> project to do gender and age analysis on the discovered faces. This model is pre-trained and built on top of MxNet.</p><p>To do Tinder work, we use <a href=https://github.com/cansik/sharp-tinder>Sharp-Tinder</a>, to which we contributed a patch including .NET Core support.</p><h1 id=overall-system-architecture>Overall System Architecture</h1><p><img src=/ml/swipr/OverallArch.png alt="System architcture"></p><p>We&rsquo;ll get into the details in subsequent posts, but roughly, our server calls out to Tinder to receive matches, sends pictures over to the model service to get some predictions, sends an action to tinder based on those predictions, and then updates our datastore.</p><h1 id=moving-on>Moving On</h1><p>As a general rule, because each bullet from the process overview carries its own complexity, we will devote an entire post to each individual bullet.</p><p>Our next section will explore the broad project requirements.</p><p><a href=/posts/ml/swipr02>Next Section - Outlining the Scope</a></p><h3>Posts in this series</h3><ul><li><a href=/posts/ml/swipr10/>Swipr - Server</a></li><li><a href=/posts/ml/swipr09/>Swipr - Datastore</a></li><li><a href=/posts/ml/swipr08/>Swipr - LibSwipr</a></li><li><a href=/posts/ml/swipr07/>Swipr - Swipr Script Service</a></li><li><a href=/posts/ml/swipr06/>Swipr - Fast.ai and CNNs</a></li><li><a href=/posts/ml/swipr05/>Swipr - Data Cleaning</a></li><li><a href=/posts/ml/swipr04/>Swipr - Data Collection (Part 2 of 2)</a></li><li><a href=/posts/ml/swipr03/>Swipr - Data Collection (Part 1 of 2)</a></li><li><a href=/posts/ml/swipr02/>Swipr - Scope</a></li><li><a href=/posts/ml/swipr01/>Swipr - Overview</a></li></ul></div><div class=post__footer><span><a class=category href=/categories/machine-learning/>machine learning</a><a class=category href=/categories/fast%2eai/>fast.ai</a></span>
<span><a class=tag href=/tags/cnn/>CNN</a><a class=tag href=/tags/web-scraping/>web scraping</a><a class=tag href=/tags/data-collection/>data collection</a><a class=tag href=/tags/architecture/>architecture</a></span></div></div></main></div><footer class="footer footer__base"><ul class=footer__list><li class=footer__item>&copy;
2023</li></ul></footer><script type=text/javascript src=/js/medium-zoom.min.1248fa75275e5ef0cbef27e8c1e27dc507c445ae3a2c7d2ed0be0809555dac64.js integrity="sha256-Ekj6dSdeXvDL7yfoweJ9xQfERa46LH0u0L4ICVVdrGQ=" crossorigin=anonymous></script></body></html>